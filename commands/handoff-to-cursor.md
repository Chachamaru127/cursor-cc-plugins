# /handoff-to-cursor - Cursorへの引き継ぎレポート

Claude Code での作業完了時に、Cursor（PM）への引き継ぎレポートを生成します。

---

## 実行フロー

### Step 1: 作業内容の収集

以下を並列で実行してください：

```bash
# 変更されたファイル一覧
git diff --name-status HEAD~5

# 最近のコミット
git log --oneline -5

# 現在のブランチ
git branch --show-current
```

```bash
# CI状況（GitHub Actions の場合）
gh run list --limit 3 2>/dev/null || echo "gh CLI not available"
```

```bash
# Plans.md の現在の状態
cat Plans.md
```

### Step 2: レポートの生成

以下のフォーマットでレポートを生成してください：

---

```markdown
## 🎯 作業完了報告

**報告日時**: {{YYYY-MM-DD HH:MM}}
**担当**: Claude Code
**ブランチ**: {{現在のブランチ}}

---

### 完了タスク

- **タスク名**: {{タスクの説明}}
- **ステータス**: ✅ 完了

---

### 実施内容

1. {{実施した作業1}}
2. {{実施した作業2}}
3. {{実施した作業3}}

---

### 変更ファイル

| ファイル | 変更種別 | 変更内容 |
|---------|---------|---------|
| `{{path/to/file1}}` | 追加/修正/削除 | {{変更概要}} |
| `{{path/to/file2}}` | 追加/修正/削除 | {{変更概要}} |

---

### CI/CD 状況

- **CI**: ✅ 通過 / ❌ 失敗 / ⏳ 実行中
- **run_id**: {{run_id}}（該当する場合）

---

### 次のアクション（Cursor向け）

1. [ ] 変更内容の確認
2. [ ] staging環境での動作確認（該当する場合）
3. [ ] 本番デプロイの判断（該当する場合）

---

### 備考・注意点

{{特記事項があれば記載}}
```

---

### Step 3: Plans.md の更新

完了したタスクのマーカーを更新：

```markdown
# 変更前
- [ ] タスク名 `cc:WIP`

# 変更後
- [x] タスク名 `cc:完了` ({{YYYY-MM-DD}})
```

### Step 4: レポートの提示

生成したレポートをユーザーに提示し、以下を案内：

> 📤 **Cursorへの引き継ぎ準備完了**
>
> 上記のレポートをCursorに共有してください。
>
> **共有方法**:
> 1. このレポートをコピー
> 2. Cursor のチャットに貼り付け
> 3. または `Plans.md` を確認してもらう
>
> Cursor が確認したら、マーカーが `cursor:確認済` に更新されます。

---

## CI失敗時の対応

CIが失敗している場合は、以下のフォーマットでエスカレーション：

```markdown
## ⚠️ CI失敗報告

**失敗回数**: {{回数}}
**最新のrun_id**: {{run_id}}

### エラー内容
{{エラーログの要約}}

### 試した修正
1. {{修正1}}
2. {{修正2}}

### 推定原因
{{原因の推測}}

### Cursorへの依頼
{{具体的な依頼内容}}
```

**注意**: 3回修正を試みても失敗する場合は、自動修正を中止してエスカレーションしてください。

---

## 注意事項

- **正確な情報を記載**: 推測ではなく実際の結果を報告
- **変更ファイルを漏れなく記載**: `git diff` の結果を確認
- **次のアクションを明確に**: Cursor が何をすべきか具体的に
