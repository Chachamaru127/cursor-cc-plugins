# /init - Cursor-CC ワークフロー セットアップ

プロジェクトを Cursor ↔ Claude Code 2エージェントワークフロー用にセットアップします。
新規プロジェクト・既存プロジェクト両方に対応。

---

## 実行フロー

### Phase 1: プロジェクト分析

まず、現在のディレクトリを分析してプロジェクトの状態を判定してください。

```bash
# 以下を並列で確認
ls -la                          # ファイル一覧
[ -d .git ] && echo "Git: Yes" || echo "Git: No"
[ -f package.json ] && echo "package.json: Yes"
[ -f requirements.txt ] && echo "requirements.txt: Yes"
[ -f AGENTS.md ] && echo "AGENTS.md: Yes"
[ -f Plans.md ] && echo "Plans.md: Yes"
```

**判定基準**:
- `.git` が存在しない、または主要ファイルがほぼ空 → **新規プロジェクト** → Phase 2A へ
- コードファイルが存在する → **既存プロジェクト** → Phase 2B へ

---

## Phase 2A: 新規プロジェクトフロー（VibeCoder向け）

### Step 1: やりたいことをヒアリング（抽象的に）

ユーザーに以下の質問をしてください（1問ずつ、回答を待ってから次へ）：

> 🎯 **どんなものを作りたいですか？**
>
> ざっくりで大丈夫です。例えば：
> - 「ブログサイト」
> - 「タスク管理アプリ」
> - 「動画学習プラットフォーム」
> - 「社内ツール」

**回答を待つ**

### Step 2: 解像度を上げる質問（2-3問まで）

ユーザーの回答に応じて、以下から適切な質問を選んで聞いてください：

> 📋 **もう少し教えてください：**
>
> - 「誰が使いますか？（自分だけ / チーム / 一般公開）」
> - 「どのくらいの規模感を想定してますか？（小さく始める / 最初からしっかり）」
> - 「似てるサービスやイメージに近いものはありますか？」

**回答を待つ**

### Step 3: 技術スタックの提案（ユーザーには聞かない）

**重要**: ユーザーに技術的な選択を求めないでください。Claude Code が提案します。

WebSearch ツールを使って最新情報を調査：
```
検索クエリ例:
- "{{プロジェクトタイプ}} tech stack 2025 recommended"
- "{{プロジェクトタイプ}} best practices 2025"
- "{{フレームワーク名}} vs {{比較対象}} 2025"
```

調査結果を元に、以下の形式で提案してください：

> 💡 **「{{やりたいこと}}」を作るなら、こんな構成がおすすめです：**
>
> **🅰️ シンプル構成**（まず動くものを作りたい場合）
> - フロントエンド: Next.js + Tailwind CSS
> - バックエンド: Next.js API Routes
> - データベース: Supabase（無料枠あり）
> - メリット: 1つのプロジェクトで完結、デプロイが簡単
>
> **🅱️ フル機能構成**（将来の拡張を見据える場合）
> - フロントエンド: Next.js + Tailwind CSS
> - バックエンド: FastAPI (Python)
> - データベース: PostgreSQL + Redis
> - メリット: 柔軟性が高い、複雑な処理に対応
>
> 迷ったら **🅰️ シンプル構成** から始めるのがおすすめです。後から変更もできます。
>
> **どちらがいいですか？（A / B / おまかせ）**

**回答を待つ**

### Step 4: 最低限の確認

> 📝 **最後に2つだけ教えてください：**
>
> 1. **プロジェクト名**は何にしますか？（英語、ケバブケース推奨。例: `my-awesome-app`）
> 2. **日本語** と **英語**、どちらをメインで使いますか？

**回答を待つ**

### Step 5: ファイル生成

以下のファイルを生成してください（テンプレートは `templates/` を参照）：

1. **AGENTS.md** - 開発フロー概要（Cursor / Claude Code 両方が参照）
2. **CLAUDE.md** - Claude Code 固有の設定
3. **Plans.md** - タスク管理ファイル
4. **.claude/commands/** - Claude Code 用コマンド
5. **.cursor/commands/** - Cursor 用コマンド（オプション）
6. **README.md** - プロジェクト概要（基本的な内容）

生成時の注意：
- `{{PROJECT_NAME}}` をプロジェクト名で置換
- `{{LANGUAGE}}` を選択された言語で置換
- 技術スタック情報を適切に埋め込む

### Step 6: 次のステップを案内

> ✅ **セットアップ完了！**
>
> 次にやること：
> 1. `Plans.md` を開いて、最初のタスクを確認
> 2. Cursor で `/assign-to-cc` を実行してタスクを依頼
> 3. Claude Code で `/start-task` を実行して作業開始
>
> 💡 **Tips**:
> - 困ったら「どうすればいい？」と聞いてください
> - タスクの進捗は `Plans.md` で管理されます
> - 作業完了時は `/handoff-to-cursor` で報告

---

## Phase 2B: 既存プロジェクトフロー

### Step 1: プロジェクト構造の分析

```bash
# ディレクトリ構造を確認
find . -type f -name "*.json" -o -name "*.md" -o -name "*.ts" -o -name "*.tsx" -o -name "*.py" | head -50
```

以下を確認：
- 使用言語・フレームワーク
- 既存の設定ファイル（package.json, requirements.txt, etc.）
- 既存のドキュメント

### Step 2: 既存ファイルの確認

> 🔍 **既存プロジェクトを検出しました**
>
> 検出された構成：
> - 言語: {{検出された言語}}
> - フレームワーク: {{検出されたフレームワーク}}
> - 既存ドキュメント: {{AGENTS.md / CLAUDE.md / README.md の有無}}
>
> **Cursor-CC ワークフローを追加しますか？**
> （既存ファイルは上書きせず、必要なファイルのみ追加します）

**回答を待つ**

### Step 3: 差分ファイルの生成

既存ファイルを尊重しながら、以下を追加：

- `AGENTS.md` が無い場合 → 新規作成
- `CLAUDE.md` が無い場合 → 新規作成
- `Plans.md` が無い場合 → 新規作成
- `.claude/commands/` が無い場合 → 追加

**既存の `README.md` や設定ファイルは変更しない**

### Step 4: 次のステップを案内

> ✅ **Cursor-CC ワークフローを追加しました！**
>
> 追加されたファイル：
> - {{追加されたファイル一覧}}
>
> 次にやること：
> 1. `AGENTS.md` を確認して、ワークフローを理解
> 2. `Plans.md` に現在のタスクを記載
> 3. 作業開始時は `/start-task` を実行

---

## 注意事項

- **ユーザーに技術的な質問をしすぎない**: VibeCoder は技術選定に詳しくない前提
- **提案ベースで進める**: 「どうしますか？」より「こうするのがおすすめです」
- **最新情報を使う**: WebSearch で 2025年の最新ベストプラクティスを確認
- **シンプルに始める**: 迷ったらシンプルな構成を推奨
